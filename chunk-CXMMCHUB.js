import{a as X,b as Y}from"./chunk-HAWBMUFL.js";import{d as Z,f as tt,h as et,i as nt,j as it,k as ot,l as rt}from"./chunk-CYGHJZ7S.js";import"./chunk-3JNHXLSX.js";import{l as K,m as Q}from"./chunk-EULWDZO3.js";import{a as z}from"./chunk-AASZROM6.js";import"./chunk-3QXJ2G6C.js";import"./chunk-MLVFKVSQ.js";import{f as J,i as q}from"./chunk-YLSJXOGS.js";import"./chunk-ETOOPBGT.js";import"./chunk-77YDTVUV.js";import{Ob as $,Pb as B,Rb as F,Sb as A,Wb as j,Zb as U,ac as R,ic as G,kc as H,pc as T,sa as W}from"./chunk-2QZTAEZQ.js";import{Ca as p,Cb as L,Da as d,Dc as x,Ec as v,Fc as S,Gc as V,Hd as P,Ib as y,Ob as g,a as b,ac as s,b as N,bc as r,de as O,gc as C,jc as u,lc as c,me as I,pd as E,qb as o,qd as D,te as f,vb as w,xc as l,yc as _,yd as k,zc as h}from"./chunk-MRSEJFVA.js";function st(m,n){if(m&1&&(s(0,"div",10),l(1),r()),m&2){let e=c();o(),h(" ",e.$t("_buildTip"),`
`)}}function mt(m,n){if(m&1&&(s(0,"div"),l(1),r()),m&2){let e=c().$implicit;o(),_(e.desc)}}function lt(m,n){if(m&1){let e=C();s(0,"input",19),S("ngModelChange",function(i){p(e);let a=c().$implicit;return v(a.desc,i)||(a.desc=i),d(i)}),r()}if(m&2){let e=c().$implicit;x("ngModel",e.desc)}}function ct(m,n){if(m&1){let e=C();s(0,"a",20),u("nzOnConfirm",function(){p(e);let i=c().index,a=c();return d(a.handleDelete(i))}),l(1),r()}if(m&2){let e=c(2);g("nzPopconfirmTitle",e.$t("_confirmDel")),o(),h(" ",e.$t("_del")," ")}}function pt(m,n){if(m&1){let e=C();s(0,"tr")(1,"td")(2,"nz-switch",11),S("ngModelChange",function(i){let a=p(e).$implicit;return v(a.noOpen,i)||(a.noOpen=i),d(i)}),r()(),s(3,"td")(4,"input",12),S("ngModelChange",function(i){let a=p(e).$implicit;return v(a.name,i)||(a.name=i),d(i)}),r()(),s(5,"td")(6,"input",13),u("change",function(i){let a=p(e).index,at=c();return d(at.onColorChange(i,a))}),r(),l(7),r(),s(8,"td")(9,"input",12),S("ngModelChange",function(i){let a=p(e).$implicit;return v(a.sort,i)||(a.sort=i),d(i)}),r()(),s(10,"td"),y(11,mt,2,1,"div",14)(12,lt,1,1,"input",15),r(),s(13,"td")(14,"a",16),u("click",function(){let i=p(e).index,a=c();return d(a.moveUp(i))}),l(15),r(),s(16,"a",17),u("click",function(){let i=p(e).index,a=c();return d(a.moveDown(i))}),l(17),r(),y(18,ct,2,2,"a",18),r()()}if(m&2){let e=n.$implicit,t=c();o(2),x("ngModel",e.noOpen),o(2),x("ngModel",e.name),o(2),g("value",e.color),o(),h(" - ",e.color," "),o(2),x("ngModel",e.sort),o(2),g("ngIf",e.isInner),o(),g("ngIf",!e.isInner),o(3),_(t.$t("_moveUp")),o(2),_(t.$t("_moveDown")),o(),g("ngIf",!e.isInner)}}var M=class m{constructor(n,e){this.message=n;this.modal=e}$t=f;isSelfDevelop=O;tagList=I;submitting=!1;incrementId=Math.max(...I.map(n=>Number(n.id)))+1;ngOnInit(){}moveUp(n){if(n===0)return;let e=this.tagList[n],t=this.tagList[n-1];this.tagList[n-1]=e,this.tagList[n]=t}moveDown(n){if(n===this.tagList.length-1)return;let e=this.tagList[n],t=this.tagList[n+1];this.tagList[n+1]=e,this.tagList[n]=t}onColorChange(n,e){let t=n.target.value;this.tagList[e].color=t}handleAdd(){this.tagList.some(e=>!e.name.trim())||(this.incrementId+=1,this.tagList.unshift({id:this.incrementId,name:"",color:"#f50000",desc:"",isInner:!1}))}handleDelete(n){this.tagList.splice(n,1)}handleSubmit(){if(this.submitting)return;let n={};if(this.tagList.forEach(t=>{t.name?.trim?.()&&(n[t.name]=N(b({},t),{name:void 0}))}),Object.keys(n).length!==this.tagList.length){this.message.error(f("_repeatAdd"));return}let e=[...this.tagList].map(t=>(t.sort||="",typeof t.sort=="string"&&(t.sort=t.sort.trim()),t.sort===""&&delete t.sort,Number.isNaN(Number(t.sort))&&delete t.sort,t.sort!=null&&(t.sort=Number(t.sort)),b({},t)));this.modal.info({nzTitle:f("_syncDataOut"),nzOkText:f("_confirmSync"),nzContent:f("_confirmSyncTip"),nzOnOk:()=>{this.submitting=!0,W({message:"update tag",content:JSON.stringify(e),path:P}).then(()=>{this.message.success(f("_saveSuccess"))}).finally(()=>{this.submitting=!1})}})}trackByItem(n,e){return e.id}static \u0275fac=function(e){return new(e||m)(w(T),w(z))};static \u0275cmp=L({type:m,selectors:[["system-tag"]],features:[V([z,T])],decls:23,vars:14,consts:[["basicTable",""],["nz-button","",1,"add-btn",3,"click","nzLoading"],["nz-button","","nzType","primary",3,"click","nzLoading"],["class","mb-4 !text-red-500 font-bold",4,"ngIf"],[3,"nzData"],["nzWidth","80px"],["nzWidth","150px"],["nzWidth","160px"],["nzWidth","200px"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"mb-4","!text-red-500","font-bold"],[3,"ngModelChange","ngModel"],["nz-input","","maxlength","10",3,"ngModelChange","ngModel"],["type","color",3,"change","value"],[4,"ngIf"],["nz-input","","maxlength","20",3,"ngModel","ngModelChange",4,"ngIf"],[3,"click"],[1,"mx-2.5",3,"click"],["nz-popconfirm","","nzOkType","danger","nzPopconfirmPlacement","bottom","class","!text-red-500",3,"nzPopconfirmTitle","nzOnConfirm",4,"ngIf"],["nz-input","","maxlength","20",3,"ngModelChange","ngModel"],["nz-popconfirm","","nzOkType","danger","nzPopconfirmPlacement","bottom",1,"!text-red-500",3,"nzOnConfirm","nzPopconfirmTitle"]],template:function(e,t){if(e&1){let i=C();s(0,"button",1),u("click",function(){return p(i),d(t.handleAdd())}),l(1),r(),s(2,"button",2),u("click",function(){return p(i),d(t.handleSubmit())}),l(3),r(),y(4,st,2,1,"div",3),s(5,"nz-table",4,0)(7,"thead")(8,"tr")(9,"th",5),l(10),r(),s(11,"th",6),l(12),r(),s(13,"th",7),l(14),r(),s(15,"th",6),l(16),r(),s(17,"th",8),l(18),r(),s(19,"th",8),l(20),r()()(),s(21,"tbody"),y(22,pt,19,10,"tr",9),r()()}e&2&&(g("nzLoading",t.submitting),o(),h(" ",t.$t("_addRow"),`
`),o(),g("nzLoading",t.submitting),o(),h(" ",t.$t("_save"),`
`),o(),g("ngIf",!t.isSelfDevelop),o(),g("nzData",t.tagList),o(5),_(t.$t("_noPublic")),o(2),_(t.$t("_tagName")),o(2),_(t.$t("_color")),o(2),_(t.$t("_sort")),o(2),_(t.$t("_remark")),o(2),_(t.$t("_action")),o(2),g("ngForOf",t.tagList)("ngForTrackBy",t.trackByItem))},dependencies:[H,j,U,G,R,k,E,D,A,F,$,B,q,J,rt,nt,Z,tt,ot,et,it,Q,K,Y,X],styles:[".add-btn[_ngcontent-%COMP%]{margin-bottom:20px;margin-right:20px}"]})};export{M as default};
